{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}

{% block title %}{% if student %}Edit{% else %}Add{% endif %} Student History - School ERP{% endblock %}

{% block extra_css %}
<style>
.card-custom {
    border-radius: 0.5rem;
    border: 1px solid #dee2e6;
    margin-bottom: 2rem;
}
.section-header {
    border-left: 4px solid #0d6efd;
    padding-left: 1rem;
    margin-bottom: 1.5rem;
}
.required-field::after {
    content: " *";
    color: #dc3545;
}
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom card-custom px-2">
    <h1 class="h2">{% if student %}Edit{% else %}Add{% endif %} Student History</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <a href="{% url 'student_list' %}" class="btn btn-sm btn-secondary">
            <i class="bi bi-arrow-left me-1"></i>Back to List
        </a>
    </div>
</div>

<form method="post" novalidate>
    {% csrf_token %}

    <!-- Academic Record -->
    <div class="card card-custom p-3">
        <h4 class="section-header text-success">Academic Record</h4>
        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="{{ form.academic_year.id_for_label }}" class="form-label required-field">Academic Year</label>
                {% render_field form.academic_year class="form-select" %}
            </div>
            <div class="col-md-4 mb-3">
                <label for="{{ form.class_name.id_for_label }}" class="form-label required-field">Class</label>
                {% render_field form.class_name class="form-select" %}
            </div>
            <div class="col-md-4 mb-3">
                <label for="{{ form.section.id_for_label }}" class="form-label">Section</label>
                {% render_field form.section class="form-select" %}
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="{{ form.roll_number.id_for_label }}" class="form-label">Roll Number</label>
                {% render_field form.roll_number class="form-control" %}
            </div>
            <div class="col-md-4 mb-3">
                <label for="{{ form.final_grade.id_for_label }}" class="form-label">Final Grade</label>
                {% render_field form.final_grade class="form-control" %}
            </div>
            <div class="col-md-4 mb-3">
                <label for="{{ form.percentage.id_for_label }}" class="form-label">Percentage (%)</label>
                {% render_field form.percentage class="form-control" %}
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 mb-3">
                <label for="{{ form.result.id_for_label }}" class="form-label">Result</label>
                {% render_field form.result class="form-control" %}
            </div>
        </div>
    </div>

    <!-- Previous School Information -->
    <div class="card card-custom p-3">
        <h4 class="section-header text-primary">Previous School Information</h4>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.previous_school.id_for_label }}" class="form-label">Previous School Name</label>
                {% render_field form.previous_school class="form-control" %}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.previous_class.id_for_label }}" class="form-label">Previous Class</label>
                {% render_field form.previous_class class="form-control" %}
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.previous_marks.id_for_label }}" class="form-label">Previous Marks (%)</label>
                {% render_field form.previous_marks class="form-control" %}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.transfer_reason.id_for_label }}" class="form-label">Reason for Transfer</label>
                {% render_field form.transfer_reason class="form-control" rows="3" %}
            </div>
        </div>
    </div>

    <!-- Actions -->
    <div class="d-flex justify-content-between">
        <div>
            <button type="submit" class="btn btn-primary btn-lg">
                <i class="bi bi-save me-2"></i>{% if student %}Update{% else %}Save{% endif %} History
            </button>
            <a href="{% url 'student_list' %}" class="btn btn-secondary btn-lg">Cancel</a>
        </div>
    </div>
</form>
{% endblock %}
